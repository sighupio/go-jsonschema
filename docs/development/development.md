# Development FAQ

### **What's the purpose of the library and its general structure?**

<details>
  <summary>Answer</summary>
  
The library generates Go data structures from a JSONSchema to parse the `furyctl.yaml` file, including support for both Unmarshal and Marshal in Go, fully compatible with the standard library. The library was forked by Claudio Beatrice, who took over the original repository. To keep the library available, it was decided to fork it internally.

#### Simple example

Taking this schema as an example:

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "name": {
      "type": "string"
    },
    "age": {
      "type": "integer"
    }
  },
  "required": ["name", "age"]
}
```

The output you get is:

```go
// Code generated by github.com/sighupio/go-jsonschema, DO NOT EDIT.

package public

import "encoding/json"
import "fmt"

type ExampleSchema struct {
	// Age corresponds to the JSON schema field "age".
	Age int `json:"age" yaml:"age" mapstructure:"age"`

	// Name corresponds to the JSON schema field "name".
	Name string `json:"name" yaml:"name" mapstructure:"name"`
}

// UnmarshalJSON implements json.Unmarshaler.
func (j *ExampleSchema) UnmarshalJSON(b []byte) error {
	var raw map[string]interface{}
	if err := json.Unmarshal(b, &raw); err != nil {
		return err
	}
	if v, ok := raw["age"]; !ok || v == nil {
		return fmt.Errorf("field age in ExampleSchema: required")
	}
	if v, ok := raw["name"]; !ok || v == nil {
		return fmt.Errorf("field name in ExampleSchema: required")
	}
	type Plain ExampleSchema
	var plain Plain
	if err := json.Unmarshal(b, &plain); err != nil {
		return err
	}
	*j = ExampleSchema(plain)
	return nil
}

```

</details>

---

### **How can we track upstream changes?**

<details>
  <summary>Answer</summary>
  
Perform upstream merges, fix any conflicts, and repeat.

The upstream repository it's https://github.com/omissis/go-jsonschema, actively mantained by the developer.

Please note that we have renamed the go module to `github.com/sighupio/go-jsonschema` and made some modifications to `pkg/types/date.go` to support `UnmarshalYAML` on furyctl so the merge from the upstram will have conflicts.

</details>

---

### **How do I develop locally and test the software?**

<details>
  <summary>Answer</summary>
  
The project is developed using the standard Go tools, and testing is done using a test JSONSchema.

For example you can use vscode by configuring it to debug Go code or you can simple compile the project with `go build .` and test the executable directly.

</details>
